<!DOCTYPE html>
<html lang="en">

  <!-- Head -->
  <head>        
    <!-- Metadata, OpenGraph and Schema.org -->
    

    <!-- Standard metadata -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>Naeun  Oh | Event Segmentation</title>
    <meta name="author" content="Naeun  Oh" />
    <meta name="description" content="how the brain segments info" />
    <meta name="keywords" content="jekyll, jekyll-theme, academic-website, portfolio-website" />


    <!-- Bootstrap & MDB -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha256-DF7Zhf293AJxJNTmh5zhoYYIMs2oXitRfBjY+9L//AY=" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous" />

    <!-- Fonts & Icons -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.15.4/css/all.min.css" integrity="sha256-mUZM63G8m73Mcidfrv5E+Y61y7a12O5mW4ezU3bxqW4=" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/academicons@1.9.1/css/academicons.min.css" integrity="sha256-i1+4qU2G2860dGGIOJscdC30s9beBXjFfzjWLjBRsBg=" crossorigin="anonymous">
    <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons">

    <!-- Code Syntax Highlighting -->
    <link rel="stylesheet" href="https://gitcdn.link/repo/jwarby/jekyll-pygments-themes/master/github.css" />

    <!-- Styles -->
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>ðŸ”¥</text></svg>">
    <link rel="stylesheet" href="/assets/css/main.css">
    <link rel="canonical" href="https://naeunoh.github.io/blog/2022/event-segmentation/">

    <!-- Dark Mode -->
    <script src="/assets/js/theme.js"></script>
    <script src="/assets/js/dark_mode.js"></script>
  </head>

  <!-- Body -->
  <body class="fixed-top-nav">

    <!-- Header -->
    <header>

      <!-- Nav Bar -->
      <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top">
        <div class="container">
          <a class="navbar-brand title font-weight-lighter" href="https://naeunoh.github.io/"><span class="font-weight-bold">Naeun</span>   Oh</a>
          <!-- Navbar Toggle -->
          <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar top-bar"></span>
            <span class="icon-bar middle-bar"></span>
            <span class="icon-bar bottom-bar"></span>
          </button>

          <div class="collapse navbar-collapse text-right" id="navbarNav">
            <ul class="navbar-nav ml-auto flex-nowrap">

              <!-- About -->
              <li class="nav-item ">
                <a class="nav-link" href="/">about</a>
              </li>
              
              <!-- Blog -->
              <li class="nav-item active">
                <a class="nav-link" href="/blog/">blog</a>
              </li>

              <!-- Other pages -->
              <li class="nav-item ">
                <a class="nav-link" href="/projects/">projects</a>
              </li>
              <li class="nav-item ">
                <a class="nav-link" href="/publications/">publications</a>
              </li>
              <li class="nav-item dropdown ">
                <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">submenus</a>
                <div class="dropdown-menu dropdown-menu-right" aria-labelledby="navbarDropdown">
                  <a class="dropdown-item" href="/publications/">publications</a>
                  <div class="dropdown-divider"></div>
                  <a class="dropdown-item" href="/projects/">projects</a>
                </div>
              </li>

              <!-- Toogle theme mode -->
              <div class="toggle-container">
                <a id="light-toggle">
                  <i class="fas fa-moon"></i>
                  <i class="fas fa-sun"></i>
                </a>
              </div>
            </ul>
          </div>
        </div>
      </nav>
    </header>

    <!-- Content -->
    <div class="container mt-5">
      <!-- _layouts/post.html -->

<div class="post">

  <header class="post-header">
    <h1 class="post-title">Event Segmentation</h1>
    <p class="post-meta">August 10, 2022</p>
    <p class="post-tags">
      <a href="/blog/2022"> <i class="fas fa-calendar fa-sm"></i> 2022 </a>
      Â  Â· Â 
        <a href="/blog/tag/neuroimaging">
          <i class="fas fa-hashtag fa-sm"></i> neuroimaging</a> Â 
          <a href="/blog/tag/psychology">
          <i class="fas fa-hashtag fa-sm"></i> psychology</a> Â 
          <a href="/blog/tag/analysis-methods">
          <i class="fas fa-hashtag fa-sm"></i> analysis-methods</a> Â 
          
      Â  Â· Â 
        <a href="/blog/category/naturalistic-data-analysis">
          <i class="fas fa-tag fa-sm"></i> naturalistic-data-analysis</a> Â 
          

    </p>
  </header>

  <article class="post-content">
    <p>This section shows how to detect event boundaries in fMRI data, which is defined as shifts in spatial patterns of voxel activity, and align events across perception and recall. This is especially important for naturalistic tasks where various events fluctuate across time and it may be hard to clearly identify which events are happening at timepoints, compared to controlled tasks that have predefined structures (e.g. blocks, events).</p>

<p>Weâ€™ll show how both <strong>Hidden Markov Model (HMM)</strong> and <strong>Greedy State Boundary Search (GSBS)</strong> can be used to find boundaries, and how the HMM or GSBS+HMM can be used to track reactivation of event patterns during free recall.</p>

<p><a href="https://youtu.be/-iDMphdGVxo" target="_blank" rel="noopener noreferrer">This video</a> by Dr. Chris Baldassano, PhD introduces event segmentation using HMMs.</p>

<p><a href="https://youtu.be/KvwzjRtbJ6U" target="_blank" rel="noopener noreferrer">This video</a> by Dr. Linda Geerligs, PhD will discuss event segmentation using GSBS.</p>

<p>Iâ€™ve summarized the content of the videos here.</p>

<h4 id="event-segmentation---hmm"><strong>Event Segmentation - HMM</strong></h4>

<p>We divide naturalistic environments into discrete events, separated by event boundaries. These event boundaries are known to influence the dynamics of perception, immediate recall, and long-term memory.</p>

<p>How do we identify event boundaries? First, human observers can annotate when event boundaries occur (coarse and fine timescale) and check whether brain regions show response at boundaries. The problem is that every brain region may have different event boundaries so itâ€™s hard to generate all the possible hypotheses on where the boundaries might be.</p>

<p>Instead, can we find event boundaries directly from fMRI data? The basic idea is to identify event boundaries as shifts in fMRI activity patterns. For example, if we look at these three voxel time courses, we can identify two moments at which these voxels show shifts in activities, diving up the time courses into three events, each of which has a characteristic spatial pattern of activity.</p>

<p><img src="/assets/img/es/eventsegexample.png" alt="eventseg" width="50%"></p>

<p>We can see this temporal structure by looking at the angular gyrus during the beginning of the Sherlock dataset. If we take the spatial patterns in the angular gyrus and measure the correlation between all pairs of timepoints, we can obtain a matrix with <strong>blocky structure along the diagonal</strong>. This is the type of structure weâ€™re looking for in event boundaries.</p>

<p><img src="/assets/img/es/hmm-blockpattern.png" alt="hmm-block" width="100%"></p>

<p><strong>Hidden Markov Model (HMM)</strong> assumes the brain moves through a sequence of latent states which correspond to events (\(s_t\)). We observe a sequence of brain activity (\(b_t\)). Every event has some characteristic pattern of activity (\(m_k\)). All brain activities occurring during that event should be correlated with that characteristic. Thus, given a sequence of brain activity (\(b_t\)), we can infer where event boundaries are (which event every time point belongs to, \(s_t\)) and what these characteristic event patterns are (\(m_k\)). The model alternates between estimating variables \(s_t\) and \(m_k\) until convergence.</p>

<p><img src="/assets/img/es/hmm.png" alt="hmm" width="100%"></p>

<p>HMM requires choosing the number of boundaries we want to find. One option is to fit the model on N-1 subjects to find boundaries and look at spatial pattern correlations within and across boundaries. We can choose the number of events (\(k\)) that maximizes the <strong>within vs across (all other states) event boundary correlation (WAC)</strong>. Another approach is to look at the <strong>log-likelihood</strong> of the model, which is to look at the model fit. We can train the model on some subjects can measure the model fit on other subjects, determining the number of events for which this model log-likelihood is highest.</p>

<p>After identifying event boundaries of the model in different brain regions, we can <strong>compare those boundaries to those annotated by human observers</strong>. In general, we found that regions like the angular gyrus and the posterior medial cortex have event boundaries that correspond well with human annotated boundaries. When we look at how the optimal number of event boundaries varies across regions, we find a gradient from the sensory cortex to higher-level cortex such that regions like the visual cortex and auditory cortex have a large number of event boundaries, whereas high-level cortex have longer events in the scale of up to a minute in length.</p>

<p>How do we use the event boundaries that we found?</p>
<ol>
  <li>
    <p>Correlation between the number of event boundaries and characteristics of the stimuli (states)</p>
  </li>
  <li>
    <p>Find shared event patterns across datasets with potentially different timings in order to :</p>
    <ul>
      <li>compare different modalities (e.g. movie vs audio of same story shows modality-independent pattern sequences in some brain regions)</li>
      <li>compare perception and later free recall (e.g. reactivation of events during free recall)</li>
      <li>detect temporal shifts between first and rewatch of movies (e.g. after rewatch, event boundaries shift earlier in time up to 12 seconds)</li>
      <li>see if different stories have similar underlying temporal structure (e.g. find brain regions that can classify schematic event sequences of stories-mpfc)</li>
    </ul>
  </li>
</ol>

<p>This HMM approach has also been applied to other neuroimaging modalities such as EEG.</p>

<h4 id="event-segmentation--gsbs"><strong>Event Segmentation â€“ GSBS</strong></h4>

<p>Events organize our experience over time by transforming continuous inputs into units that can be understood and remembered. Events are shared across participants, organized hierarchically. How does the brain segment information over time into neural states?</p>

<p>Testing the event segmentation method introduced by Baldassano et al. (2018), we found some issues : within vs across event boundary correlation leads to over-estimation of the number of states. Also, HMM takes a long time to fit.</p>

<p>Thus, we built a state boundary detection method that: detects state boundaries and the optimal number of states, does not have any assumptions about where state boundaries should be (data-driven), and is fast. The greedy state boundary search (GSBS) using a greedy search approach to find boundaries iteratively.</p>

<p>First, find the initial state boundary from all the timepoints :</p>

<ol>
  <li>Taking each timepoint as a boundary, calculate mean activity pattern per state that is divided by the boundary (i.e. states before and after boundaries)</li>
  <li>For all the potential boundaries (timepoints), calculate how much the original voxel activity time course in a state can be explained by the mean activity pattern in the corresponding state (i.e. correlation)</li>
  <li>average the correlations for all the boundaries (i.e. timepoints) thus getting a single estimate for the fit,</li>
  <li>find the optimal boundary (timepoint) when average correlation is highest (max).</li>
</ol>

<p>Now, the first state boundary is set (thatâ€™s why this is greedy). Then, we repeat the process to find the next boundary until we find the number of boundaries we aimed for.</p>

<p><img src="/assets/img/es/gsbs.png" alt="gsbs" width="100%"></p>

<p>So, how do we determine the number of boundaries? In the time x time correlation matrix, we look at within state correlations and between consecutive state correlations. With the distribution of within state correlations and the distribution between consecutive state correlations, we find the optimal \(k\) number of state boundaries where the distance between the two distributions is maximal (i.e., when within state correlation is highest and between consecutive state correlation is lowest). To measure the distance, we use <strong>T-distance</strong> by running t-tests contrasting the within and between state correlation for each potential number of states and finding the maximum T-distance.</p>

<p><img src="/assets/img/es/gsbs-numofboundaries.png" alt="gsbs-num" width="100%"></p>

<p>We compared HMM and GSBS methods on simulated data. As states had more varying lengths, GSBS maintained high accuracy but HMMâ€™s accuracy dropped. When looking at the worst performing simulation for HMM, <strong>HMM over-estimates the number of state boundaries as it detects states with approximately the same lengths.</strong> When looking at GSBS with the same low performance has HMM, <strong>GSBS detects all the boundaries with slight delays in some.</strong> Note that the split-merge option in the latest implementation of the HMM-method is partially accounted for the over-estimation issue.</p>

<p>As for determining the number of states, GSBS accurately estimates the number of states whereas HMMâ€™s WAC tends to over-estimate the number of states especially as there are more states. However, GSBS does over-estimate when there is more noise in the data. While LOO CV still gave over-estimation, averaging the data across subjects accurately estimated the number of states (in simulated and real data).</p>

<p>The weakness of GSBS is that it is difficult to match neural states across datasets (because itâ€™s data driven?). Thus, we suggest a method combing GSBS and HMM by estimating the neural states in one dataset and using HMM to identify the same activity patterns in a different dataset.</p>

<p>Examining the duration of states identified by GSBS in the whole brain, we found a brain-wide hierarchy in the timescales of information processing, where sensory regions show short neural states and regions such as the medial prefrontal cortex show long periods of information integration. We also correlated the behaviorally identified event boundaries and neural state boundaries, considering the possible delays of 4-8 seconds and using permutation for significance testing.</p>

<p>Some state transitions are stronger than others. Using the correlation distance between mean neural activity pattern of states as the strength of boundaries, we find more areas that co-occur with subjective boundaries. Thus, stronger event boundaries (strong state transitions) are more likely to be accompanied with the subjective experience of boundaries.</p>

  </article>

</div>

    </div>

    <!-- Footer -->    
    <footer class="fixed-bottom">
      <div class="container mt-0">
        Â© Copyright 2023 Naeun  Oh. Powered by <a href="http://jekyllrb.com/" target="_blank" rel="noopener noreferrer">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio" target="_blank" rel="noopener noreferrer">al-folio</a> theme. Hosted by <a href="https://pages.github.com/" target="_blank" rel="noopener noreferrer">GitHub Pages</a>. Photos from <a href="https://unsplash.com" target="_blank" rel="noopener noreferrer">Unsplash</a>.

      </div>
    </footer>

    <!-- JavaScripts -->
    <!-- jQuery -->
  <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>

    <!-- Bootsrap & MDB scripts -->
  <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.2/dist/umd/popper.min.js" integrity="sha256-l/1pMF/+J4TThfgARS6KwWrk/egwuVvhRzfLAMQ6Ds4=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/js/bootstrap.min.js" integrity="sha256-SyTu6CwrfOhaznYZPoolVw2rxoY7lKYKQvqbtqN93HI=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script>

    <!-- Mansory & imagesLoaded -->
  <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script>
  <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@4/imagesloaded.pkgd.min.js"></script>
  <script defer src="/assets/js/mansory.js" type="text/javascript"></script>
    
  <!-- Medium Zoom JS -->
  <script src="https://cdn.jsdelivr.net/npm/medium-zoom@1.0.6/dist/medium-zoom.min.js" integrity="sha256-EdPgYcPk/IIrw7FYeuJQexva49pVRZNmt3LculEr7zM=" crossorigin="anonymous"></script>
  <script src="/assets/js/zoom.js"></script><!-- Load Common JS -->
  <script src="/assets/js/common.js"></script>

    <!-- MathJax -->
  <script type="text/javascript">
    window.MathJax = {
      tex: {
        tags: 'ams'
      }
    };
  </script>
  <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js"></script>
  <script defer src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>

    
  </body>
</html>

